#!/bin/sh
user=${DOCKER_USER:-jekyll}
root=$(cd "$(dirname "$(readlink -f $0)")/.."; pwd)
repo=${DOCKER_REPO:-jekyll}
$root/script/sync
set -e

cd $root
if [ $# -eq 1 ] && [ -d "images/$1" ]; then
  cd $root/images/$1
  docker build -t \
    $user/$repo:$1 .

elif [ $# -gt 0 ]; then
  >&2 echo "Bad Image"
  exit 1
else
  for v in options/versions/*; do
    $0 "$(
      basename $v
    )"
  done
fi
